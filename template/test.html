<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MOC Report</title>
  <style>
    /* Basic page & print setup */
    @page {
      size: A4;
      margin: 15mm;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: Arial, Helvetica, sans-serif;
      margin: 0;
      padding: 0;
      /* Keep outside area white; page containers carry the GOV gradient */
      background: #ffffff;
      color: #333;
    }

    .page {
      width: 210mm;
      min-height: 297mm;
      margin: 8px auto;
      /* Government-themed page background (saffron -> white -> green) */
      background: linear-gradient(180deg, #fff3e6 0%, #ffffff 48%, #eef8f0 100%);
      padding: 12mm 12mm 18mm;
      position: relative;
      box-shadow: 0 0 4px rgba(0, 0, 0, 0.12);
      page-break-after: always;
      /* subtle left/right accent lines matching gov colors */
      border-left: 6px solid rgba(255,153,51,0.12);
      border-right: 6px solid rgba(19,136,8,0.07);
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }

    /* Ensure printer respects background colors */
    @media print {
      .page { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    }

    .page:last-child {
      page-break-after: auto;
    }

    /* watermark / subtle background emblem */
    .page::before{
      content: '';
      position: absolute;
      top: 36px;
      left: 36px;
      width: 460px;
      height: 120px;
      background-image: url('assets/moc.jpg');
      background-size: contain;
      background-repeat: no-repeat;
      opacity: 0.06;
      pointer-events: none;
      z-index: 0;
    }

    /* Ensure all page children are above the watermark */
    .page > * {
      position: relative;
      z-index: 1;
    }

    :root{
      /* Government of India palette */
      --gov-saffron: #ff9933;
      --gov-green: #138808;
      --gov-navy: #002855;
      --gov-mid: #6b6f71;
      --gov-light: #ffffff;
      --paper-bg: #fbfbfb;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 20px;
    }

    .header-left {
      display:flex;
      align-items:flex-start;
      gap:12px;
    }

    .moc-logo{
      height:64px;
      width:auto;
      object-fit:contain;
      margin-top:4px;
    }

    .header-title {
      font-size: 22px;
      font-weight: bold;
      color: var(--coal-navy);
    }

    .header-subtext {
      font-size: 11px;
      max-width: 320px;
      margin-top: 6px;
      line-height: 1.4;
    }

    .candidate-info {
      font-size: 11px;
      text-align: right;
      line-height: 1.5;
    }

    .candidate-info .label {
      font-weight: bold;
    }

    .overall-section {
      display: flex;
      margin-top: 20px;
    }

    .overall-left {
      flex: 2;
      padding-right: 20px;
      border-right: 1px solid #ddd;
    }

    .overall-right {
      flex: 3;
      padding-left: 20px;
    }

    .overall-score-box {
      display: flex;
      align-items: center;
      gap: 25px;
    }

    .overall-score-circle {
      width: 90px;
      height: 90px;
      border-radius: 50%;
      border: 4px solid var(--coal-navy);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: var(--coal-navy);
      background: linear-gradient(180deg, rgba(0,0,0,0.02), transparent);
    }

    .overall-score-circle .score-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .overall-score-circle .score-value {
      font-size: 26px;
      margin-top: 3px;
    }

    .overall-score-details {
      font-size: 11px;
      line-height: 1.5;
    }

    .overall-score-details .cefr {
      font-size: 13px;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .intelligibility-box {
      margin-top: 20px;
      padding: 10px 12px;
      background: var(--coal-light);
      border-left: 4px solid var(--coal-navy);
      font-size: 11px;
      line-height: 1.5;
    }

    .intelligibility-box .title-row {
      display: flex;
      justify-content: space-between;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .skill-summary-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 25px;
      font-size: 11px;
    }

    .skill-summary-table th,
    .skill-summary-table td {
      padding: 6px 4px;
      text-align: center;
    }

    .skill-summary-table th {
      font-weight: bold;
      border-bottom: 1px solid #ccc;
      font-size: 11px;
    }

    .skill-summary-table .skill-name {
      text-align: left;
      font-weight: bold;
    }

    .scale-legend {
      margin-top: 10px;
      font-size: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .scale-bar {
      position: relative;
      height: 10px;
      background: linear-gradient(90deg,#e9ecec,#f7f7f7);
      border-radius: 6px;
      margin-top: 8px;
      margin-bottom: 8px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
    }

    .scale-marker {
      position: absolute;
      top: -5px;
      width: 4px;
      height: 20px;
      background: var(--coal-navy);
      border-radius: 2px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.12);
    }

    .scale-labels {
      display: flex;
      justify-content: space-between;
      font-size: 9px;
      margin-top: 4px;
      color: var(--coal-mid);
    }

    .skill-row {
      margin-top: 10px;
    }

    .skill-row-header {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      margin-bottom: 4px;
    }

    .skill-row-header .score {
      font-weight: bold;
    }

    .score-badges {
      display: flex;
      gap: 12px;
      margin-top: 6px;
      font-size: 10px;
      color: #666;
    }

    .score-badges span {
      padding: 2px 6px;
      border-radius: 3px;
      background: #f5f5f5;
    }

    .footer {
      position: absolute;
      bottom: 15mm;
      left: 20mm;
      right: 20mm;
      font-size: 9px;
      color: #777;
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
    }

    .footer-left {
      max-width: 65%;
      line-height: 1.3;
    }

    .footer-right {
      text-align: right;
      font-size: 9px;
    }

    .page-number {
      margin-top: 6px;
    }

    /* Page 2 styles */

    .section-title {
      font-size: 15px;
      font-weight: bold;
      color: var(--coal-navy);
      margin-bottom: 10px;
    }

    .capability-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px 18px;
      font-size: 11px;
      margin-top: 10px;
      margin-bottom: 18px;
    }

    .capability-card {
      border: 1px solid #e2e2e2;
      padding: 12px 14px;
      border-radius: 6px;
      background: #ffffff;
      min-height: 150px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .capability-header {
      font-weight: bold;
      margin-bottom: 4px;
      color: var(--coal-navy);
    }

    .capability-meta {
      font-size: 10px;
      color: #666;
      margin-bottom: 8px;
    }

    .capability-text {
      font-size: 11px;
      line-height: 1.4;
      margin-bottom: 8px;
      flex: 1 1 auto;
    }

    .tips-title {
      font-size: 10px;
      font-weight: bold;
      margin-top: 4px;
      margin-bottom: 2px;
    }

    .tips-list {
      font-size: 10px;
      margin-left: 12px;
      margin-top: 6px;
      margin-bottom: 0;
      padding-left: 12px;
    }

    .tips-list li {
      margin-bottom: 2px;
    }

    .understanding-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px 16px;
      margin-top: 10px;
      font-size: 11px;
    }

    .understanding-block {
      border: 1px solid #e6e6e6;
      border-radius: 6px;
      padding: 10px 12px;
      background: #ffffff;
      min-height: 80px;
    }

    .understanding-title {
      font-weight: bold;
      margin-bottom: 4px;
      color: var(--coal-navy);
    }

    .understanding-text {
      font-size: 11px;
      line-height: 1.4;
    }

    .tin-note {
      margin-top: 8px;
      font-size: 10px;
    }

    /* Banner and Employee Info */
    .banner {
      width: 100%;
      height: 92px;
      background-color: var(--paper-bg);
      border-left: 6px solid var(--gov-saffron);
      border-right: 6px solid var(--gov-green);
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px;
      color: var(--gov-navy);
      margin-bottom: 14px;
    }

    .banner .banner-left {
      display:flex;
      align-items:center;
      gap:12px;
    }

    .banner .banner-title {
      font-size: 20px;
      font-weight: 800;
      color: var(--gov-navy);
      text-transform: uppercase;
      letter-spacing: 0.6px;
    }

    .banner .gov-sub {
      font-size: 12px;
      color: var(--gov-navy);
      opacity: 0.9;
      margin-top: 4px;
    }

    .employee-info {
      width: 100%;
      border: 1px solid #e6e6e6;
      margin: 10px 0 12px 0;
      border-radius: 6px;
      overflow: hidden;
      background: #fff;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
    }

    .employee-info table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      background: #fff;
    }

    .employee-info th,
    .employee-info td {
      padding: 8px 10px;
      border-right: 1px solid #e6e6e6;
      vertical-align: middle;
    }

    .employee-info th {
      background: linear-gradient(90deg,#f7f7f7,#ffffff);
      font-weight: 700;
      text-transform: uppercase;
      font-size: 11px;
      color: var(--gov-navy);
    }

    .employee-info td:last-child,
    .employee-info th:last-child {
      border-right: none;
    }

    /* Main review layout: left stacked percentage badges, right detail sections */
    .review-main {
      display: grid;
      grid-template-columns: 120px 1fr;
      gap: 20px;
      align-items: start;
      margin-top: 6px;
    }

    .left-stats {
      display: flex;
      flex-direction: column;
      gap: 20px;
      align-items: center;
      padding-top: 6px;
    }

    .percent-circle {
      width: 96px;
      height: 96px;
      border-radius: 50%;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      color: #111;
      font-weight:800;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      background: #fff;
      text-align:center;
    }

    .percent-circle .pct-value {
      font-size: 20px;
      line-height: 1;
    }

    /* colored rings (outer border) */
    .pct-1 { border: 8px solid var(--gov-saffron); }
    .pct-2 { border: 8px solid var(--gov-green); }
    .pct-3 { border: 8px solid #2b8fd6; }
    .pct-4 { border: 8px solid var(--gov-navy); }

    /* Stats grid (top-right) */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin: 8px 0 14px 0;
    }

    .stat-card {
      background: white;
      border: 1px solid #e7e7e7;
      padding: 10px 12px;
      border-radius: 6px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.03);
      text-align: center;
      font-size: 13px;
    }

    .stat-card .value { font-size: 20px; font-weight: 800; color: var(--gov-navy); }
    .stat-card .label { font-size: 11px; color: #666; margin-top: 4px; }

    .review-sections {
      display:flex;
      flex-direction:column;
      gap: 18px;
    }

    .review-section {
      display:block;
    }

    .review-section .section-title {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 6px;
      color: var(--coal-dark);
    }

    .review-section .section-text {
      font-size: 12px;
      margin-bottom: 6px;
      color: #333;
    }

    .review-section ul {
      margin: 6px 0 0 18px;
      padding: 0;
      font-size: 12px;
      color: #333;
    }

    .review-section ul li { margin-bottom: 6px; }

    /* Hide original vertical chart and provide horizontal chart styles */
    .vertical-bar-chart { display: none; }

    /* Vertical graded chart styles */
    .vertical-graded-chart { display:flex; gap:12px; align-items:flex-start; margin-top:18px; width:100%; }
    .y-axis { width:70px; position:relative; height:220px; display:flex; flex-direction:column; justify-content:flex-end; padding-left:6px; box-sizing:border-box; font-size:12px; color:var(--gov-navy); }
    .y-axis .y-label { position:absolute; left:6px; transform:translateY(50%); background:transparent; padding:2px 6px; border-radius:6px; box-shadow:none; font-weight:700; }
    .y-axis .y-c { bottom: 25%; }
    .y-axis .y-b { bottom: 50%; }
    .y-axis .y-a { bottom: 75%; }
    .y-axis .y-ap { bottom: 90%; }

    .v-chart { flex:1 1 auto; display:flex; align-items:flex-end; gap:18px; padding:6px 12px; box-sizing:border-box; height:220px; position:relative; }
    .v-chart::before { content:''; position:absolute; left:0; right:0; top:0; bottom:0; background-image: linear-gradient(to bottom, rgba(0,0,0,0.04) 25%, transparent 25%), linear-gradient(to bottom, rgba(0,0,0,0.04) 50%, transparent 50%), linear-gradient(to bottom, rgba(0,0,0,0.04) 75%, transparent 75%); background-size:100% 25%; opacity:0.06; pointer-events:none; }
    .v-bar { width:90px; display:flex; flex-direction:column; align-items:center; gap:6px; }
    .bar-wrap { width:100%; display:flex; align-items:flex-end; position:relative; overflow:visible; }
    .bar-fill { width:100%; height:0%; border-radius:8px 8px 0 0; transition:height 900ms cubic-bezier(.2,.8,.2,1); }

    /* in-bar percentage label */
    .bar-pct { position:absolute; left:50%; transform:translateX(-50%); color:#fff; font-weight:900; font-size:14px; text-shadow:0 1px 0 rgba(0,0,0,0.35); z-index:4; padding:2px 6px; }

    /* grade guide lines */
    .v-chart .grade-line { position:absolute; left:0; right:0; height:0; border-top:2px dashed rgba(0,0,0,0.12); pointer-events:none; }
    .v-chart .grade-line.g90 { bottom:90%; }
    .v-chart .grade-line.g75 { bottom:75%; }
    .v-chart .grade-line.g50 { bottom:50%; }

    .bar-label { font-weight:700; font-size:13px; color:var(--gov-navy); text-align:center; }

    /* overall score line + marker */
    .v-chart .overall-line { position:absolute; left:0; right:0; height:0; border-top:2px solid #f39c12; pointer-events:none; display:block; z-index:3; }
    .v-chart .overall-line .overall-marker { position:absolute; left:-28px; top:-14px; width:24px; height:24px; background:#f39c12; color:#fff; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:800; box-shadow:0 2px 6px rgba(0,0,0,0.12); border:2px solid #fff; font-size:12px; }

    /* small grade boxes aligned to guide lines */
    /* grade boxes removed per user request */

    /* same gradients reused for bars */
    .bar-fill.col-1 { background: linear-gradient(180deg,#1e90ff,#0033aa); }
    .bar-fill.col-2 { background: linear-gradient(180deg,#009688,#00695c); }
    .bar-fill.col-3 { background: linear-gradient(180deg,#f0b429,#c77a00); }
    .bar-fill.col-4 { background: linear-gradient(180deg,#00c8b8,#007f5f); }
    .bar-fill.col-5 { background: linear-gradient(180deg,#7e57c2,#5e35b1); }
    .bar-fill.col-6 { background: linear-gradient(180deg,#d81b60,#8e0f3a); }

  </style>
</head>
<body>

<!-- ================= PAGE 1 ================= -->
<div class="page">
  <div class="banner">
    <div class="banner-left" style="display:flex;align-items:center;gap:12px;">
      <img src="assets/moc.jpg" style="height:56px;" alt="MoC" />
      <div>
        <div style="font-size:14px;font-weight:700;color:var(--gov-navy);">Government of India</div>
        <div class="banner-title">Ministry of Coal</div>
        <div class="gov-sub">Project Evaluation Report • Confidential</div>
      </div>
    </div>
    <div class="banner-right" style="text-align:right;">
      <div style="font-size:12px;color:#444;">Report ID: MOC-2025-1234</div>
      <div style="font-size:11px;color:#777;margin-top:6px;">Generated: 20 Nov 2025</div>
    </div>
  </div>

  <div class="employee-info">
    <table>
      <tr>
        <th>Project Title</th>
        <td colspan="3">Integrated Coal Waste-to-Energy Demonstration Project</td>
      </tr>
      <tr>
        <th>Principal Investigator</th>
        <td>Dr. A. K. Sharma</td>
        <th>Institute</th>
        <td>National Institute of Coal Research</td>
      </tr>
      <tr>
        <th>Submission Date</th>
        <td>15 Oct 2025</td>
        <th>Requested Budget (INR)</th>
        <td>₹ 18,500,000</td>
      </tr>
      <tr>
        <th>Project Duration</th>
        <td>30 months</td>
        <th>Proposal ID</th>
        <td>MOC-PROP-2025-0047</td>
      </tr>
    </table>
  </div>

  <div class="stats-grid">
    <div class="stat-card"><div class="value">82%</div><div class="label">Overall Score</div></div>
    <div class="stat-card"><div class="value">0.18</div><div class="label">Risk Index</div></div>
    <div class="stat-card"><div class="value">₹185 lak</div><div class="label">Requested Funds</div></div>
    <div class="stat-card"><div class="value">30 mo</div><div class="label">Duration</div></div>
  </div>

  <div class="review-main">
    <div class="left-stats">
      <div class="percent-circle pct-1"><div class="pct-value">82%</div><div style="font-size:11px;margin-top:6px;">Novelty</div></div>
      <div class="percent-circle pct-2"><div class="pct-value">74%</div><div style="font-size:11px;margin-top:6px;">Feasibility</div></div>
      <div class="percent-circle pct-3"><div class="pct-value">71%</div><div style="font-size:11px;margin-top:6px;">Cost Efficiency</div></div>
      <div class="percent-circle pct-4"><div class="pct-value">55%</div><div style="font-size:11px;margin-top:6px;">Deliverable</div></div>
    </div>

    <div class="review-sections">
      <div class="review-section">
        <div class="section-title">Executive Summary</div>
        <div class="section-text">This proposal demonstrates strong technical novelty in converting coal waste to clean energy at pilot scale. The methodology is sound and builds on prior national trials, with appropriate risk mitigations. Key recommendation: proceed to conditional funding subject to clarifications in cost breakdown and timeline milestones.</div>
        <ul>
          <li>Novelty: high — introduces integrated gasification + carbon capture module.</li>
          <li>Technical Maturity: medium-high; requires pilot commissioning support.</li>
        </ul>
      </div>

      <div class="review-section">
        <div class="section-title">Technical Feasibility</div>
        <div class="section-text">Detailed engineering plans were provided. The PI demonstrates sector experience and access to pilot facilities. Critical path items include feedstock supply assurance and emissions control testing.</div>
        <ul>
          <li>Key dependencies: feedstock logistics, emissions certification.</li>
          <li>Mitigations: proposed phased commissioning and third-party testing.</li>
        </ul>
      </div>

      <div class="review-section">
        <div class="section-title">Cost Justification</div>
        <div class="section-text">Budget appears aligned to pilot scale; however line-item detail is insufficient for procurement items above ₹5M. Recommend conditional release tied to improved procurement plan.</div>
        <ul>
          <li>Capital intensity is concentrated in specialized equipment (35% of budget).</li>
          <li>Operational costs are reasonable based on projected throughput.</li>
        </ul>
      </div>

      <div class="review-section">
        <div class="section-title">Timeline & Deliverables</div>
        <div class="section-text">Project timeline of 30 months is feasible with phased milestones. Request a detailed Gantt and acceptance criteria for each milestone prior to first tranche disbursement.</div>
        <ul>
          <li>Milestone 1 (0-6m): Detailed engineering and procurement.</li>
          <li>Milestone 2 (6-18m): Installation and pilot commissioning.</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Vertical graded bar chart: x-axis categories, y-axis grades -->
  <div class="vertical-graded-chart" aria-hidden="false">
    <div class="y-axis" aria-hidden="true">
      <div class="y-label y-ap">A+</div>
      <div class="y-label y-a">A</div>
      <div class="y-label y-b">B</div>
      <div class="y-label y-c">C</div>
    </div>

    <div class="v-chart" role="img" aria-label="Scores by category">
      <!-- grade guide lines: 90%, 75%, 50% -->
      <div class="grade-line g90" aria-hidden="true"></div>
      <div class="grade-line g75" aria-hidden="true"></div>
      <div class="grade-line g50" aria-hidden="true"></div>
      <!-- overall score marker (positioned by JS) -->
      <div class="overall-line" aria-hidden="true"><div class="overall-marker">0</div></div>
      <div class="v-bar" data-key="novelty">
        <div class="bar-wrap"><div class="bar-fill col-1" style="height:0%"></div><div class="bar-pct">0%</div></div>
        <div class="bar-label">Novelty</div>
      </div>

      <div class="v-bar" data-key="feasibility">
        <div class="bar-wrap"><div class="bar-fill col-2" style="height:0%"></div><div class="bar-pct">0%</div></div>
        <div class="bar-label">Feasibility</div>
      </div>

      <div class="v-bar" data-key="cost">
        <div class="bar-wrap"><div class="bar-fill col-3" style="height:0%"></div><div class="bar-pct">0%</div></div>
        <div class="bar-label">Cost</div>
      </div>

      <div class="v-bar" data-key="ai_score">
        <div class="bar-wrap"><div class="bar-fill col-4" style="height:0%"></div><div class="bar-pct">0%</div></div>
        <div class="bar-label">AI Score</div>
      </div>

      <div class="v-bar" data-key="plagiarism">
        <div class="bar-wrap"><div class="bar-fill col-5" style="height:0%"></div><div class="bar-pct">0%</div></div>
        <div class="bar-label">Plag.</div>
      </div>

      <div class="v-bar" data-key="time">
        <div class="bar-wrap"><div class="bar-fill col-6" style="height:0%"></div><div class="bar-pct">0%</div></div>
        <div class="bar-label">Deliverables</div>
      </div>
    </div>
  </div>

  <script>
    // Populate stats and animate bars (simple inline data placeholder)
    (function(){
      const data = {
        overall_score: 78,
        risk_index: 32,
        requested_funds: '₹18.5M',
        duration_months: 30,
        novelty: 80,
        feasibility: 74,
        cost: 10,
        ai_score: 100,
        plagiarism: 97,
        time: 60
      };

      // Stats grid
      const statCards = document.querySelectorAll('.stats-grid .stat-card .value');
      if(statCards && statCards.length >= 4){
        statCards[0].textContent = data.overall_score + '%';
        statCards[1].textContent = (data.risk_index).toString();
        statCards[2].textContent = data.requested_funds;
        statCards[3].textContent = data.duration_months + ' mo';
      }

      // Left percent circles (first one maps to novelty)
      const pctCircles = document.querySelectorAll('.left-stats .percent-circle .pct-value');
      if(pctCircles && pctCircles.length>=1){ pctCircles[0].textContent = data.novelty + '%'; }

      // Animate vertical bars using data-key attributes and align to v-chart guide lines
      const vchart = document.querySelector('.v-chart');
      const vbars = document.querySelectorAll('.v-chart .v-bar');
      // reserve space (px) at bottom of v-chart for labels/spacing
      const reserve = 36;
      const chartH = vchart ? vchart.clientHeight : 220;
      const availableH = Math.max(40, chartH - reserve);
      vbars.forEach((vbar, idx) => {
        const key = vbar.getAttribute('data-key');
        const pct = Number(data[key]) || 0;
        const fill = vbar.querySelector('.bar-fill');
        const pctEl = vbar.querySelector('.bar-pct');
        const wrap = vbar.querySelector('.bar-wrap');
        if(pctEl) pctEl.textContent = pct + '%';
        if(wrap) wrap.style.height = availableH + 'px';
        if(fill){
          fill.style.height = '0px';
          setTimeout(()=>{
            const h = Math.round((pct/100) * availableH);
            fill.style.height = h + 'px';
            // position percent label inside bar when tall enough, otherwise place above
            if(pctEl){
              // position label inside the colored fill (centered vertically within fill)
              if(pctEl){
                const labelCenter = Math.max(4, Math.round(h/2 - 7));
                pctEl.style.top = 'auto';
                pctEl.style.bottom = labelCenter + 'px';
                pctEl.style.color = '#fff';
                pctEl.style.fontSize = '14px';
                pctEl.style.fontWeight = '900';
                pctEl.style.textShadow = '0 1px 0 rgba(0,0,0,0.35)';
              }
            }
          }, 120 + idx*100);
        }
      });
      // draw overall score guide line and marker and position grade guide lines/boxes in px
      const overall = Number(data.overall_score) || 0;
      const overallLine = document.querySelector('.v-chart .overall-line');
      // grade thresholds
      const t90 = 90, t75 = 75, t50 = 50;
      // compute pixel mapping based on availableH (bar area) so lines align with fills
      const grade90px = Math.round((t90/100) * availableH);
      const grade75px = Math.round((t75/100) * availableH);
      const grade50px = Math.round((t50/100) * availableH);
      // set grade lines
      const gl90 = document.querySelector('.v-chart .grade-line.g90'); if(gl90) gl90.style.bottom = grade90px + 'px';
      const gl75 = document.querySelector('.v-chart .grade-line.g75'); if(gl75) gl75.style.bottom = grade75px + 'px';
      const gl50 = document.querySelector('.v-chart .grade-line.g50'); if(gl50) gl50.style.bottom = grade50px + 'px';
      // set grade boxes
      const gbAp = document.querySelector('.v-chart .grade-box.ap'); if(gbAp) gbAp.style.bottom = grade90px + 'px';
      const gbA = document.querySelector('.v-chart .grade-box.a'); if(gbA) gbA.style.bottom = grade75px + 'px';
      const gbB = document.querySelector('.v-chart .grade-box.b'); if(gbB) gbB.style.bottom = grade50px + 'px';
      const gbC = document.querySelector('.v-chart .grade-box.c'); if(gbC) gbC.style.bottom = Math.round((25/100) * availableH) + 'px';
      if(overallLine){ const overallPx = Math.round((overall/100) * availableH); overallLine.style.bottom = overallPx + 'px'; const marker = overallLine.querySelector('.overall-marker'); if(marker) marker.textContent = overall; }
    })();
  </script>

  <div class="footer">
    <div class="footer-left">
      <strong>Ministry of Coal, Government of India</strong> · Confidential · For internal evaluation purposes only.
    </div>
    <div class="footer-right">
      <div class="page-number">Page 1 of 2</div>
    </div>
  </div>
</div>

<!-- ================= PAGE 2 ================= -->
<div class="page">
  <div class="section-title">Current Capabilities in Detail</div>

  <!-- Scores summary (Page 2) -->
  <div class="page2-scores" style="display:flex;gap:12px;margin-bottom:12px;">
    <div class="score-card" style="flex:1;background:#fff;border:1px solid #e7e7e7;padding:10px;border-radius:6px;text-align:center;">
      <div style="font-size:13px;font-weight:800;color:var(--gov-navy);">Plagiarism</div>
      <div style="font-size:18px;font-weight:700;margin-top:6px;color:#111">97 / 100</div>
    </div>
    <div class="score-card" style="flex:1;background:#fff;border:1px solid #e7e7e7;padding:10px;border-radius:6px;text-align:center;">
      <div style="font-size:13px;font-weight:800;color:var(--gov-navy);">AI Score</div>
      <div style="font-size:18px;font-weight:700;margin-top:6px;color:#111">100 / 100</div>
    </div>
    <div class="score-card" style="flex:1;background:#fff;border:1px solid #e7e7e7;padding:10px;border-radius:6px;text-align:center;">
      <div style="font-size:13px;font-weight:800;color:var(--gov-navy);">Novelty</div>
      <div style="font-size:18px;font-weight:700;margin-top:6px;color:#111">80 / 100</div>
    </div>
    <div class="score-card" style="flex:1;background:#fff;border:1px solid #e7e7e7;padding:10px;border-radius:6px;text-align:center;">
      <div style="font-size:13px;font-weight:800;color:var(--gov-navy);">Cost</div>
      <div style="font-size:18px;font-weight:700;margin-top:6px;color:#111">10 / 100</div>
    </div>
    <div class="score-card" style="flex:1;background:#fff;border:1px solid #e7e7e7;padding:10px;border-radius:6px;text-align:center;">
      <div style="font-size:13px;font-weight:800;color:var(--gov-navy);">Timeline</div>
      <div style="font-size:18px;font-weight:700;margin-top:6px;color:#111">60 / 100</div>
    </div>
  </div>

  <div class="capability-grid">
    <!-- Sentence Mastery card -->
    <div class="capability-card">
      <div class="capability-header">Sentence Mastery</div>
      <div class="capability-meta">
        GSE: 62/90 &nbsp;&nbsp; Versant: 60/80 &nbsp;&nbsp; CEFR: B2
      </div>
      <div class="capability-text">
        Candidate can understand, recall and produce a variety of English phrases and clauses in sentence
        context. Candidate generally produces accurate and meaningful sentences.
      </div>
      <div class="tips-title">Tips to improve:</div>
      <ul class="tips-list">
        <li>Practice describing your educational history using the correct tense (e.g., present perfect, past perfect, past continuous, etc.).</li>
        <li>Practice rephrasing passive sentences into active sentences.</li>
      </ul>
    </div>

    <!-- Vocabulary card -->
    <div class="capability-card">
      <div class="capability-header">Vocabulary</div>
      <div class="capability-meta">
        GSE: 64/90 &nbsp;&nbsp; Versant: 61/80 &nbsp;&nbsp; CEFR: B2
      </div>
      <div class="capability-text">
        Candidate generally understands and can produce most everyday English words as they are used in
        clear colloquial speech.
      </div>
      <div class="tips-title">Tips to improve:</div>
      <ul class="tips-list">
        <li>Verbally summarize the main points of a podcast you listened to, using vocabulary from the podcast.</li>
        <li>Practice telling a well-known story from your culture in English, looking up how to translate any unknown words.</li>
      </ul>
    </div>

    <!-- Fluency card -->
    <div class="capability-card">
      <div class="capability-header">Fluency</div>
      <div class="capability-meta">
        GSE: 49/90 &nbsp;&nbsp; Versant: 51/80 &nbsp;&nbsp; CEFR: B1
      </div>
      <div class="capability-text">
        Candidate speaks with adequate rhythm but with some inappropriate phrasing and pausing. Hesitations
        and possible repetitions or false starts may sometimes interfere with the smooth flow of speech.
      </div>
      <div class="tips-title">Tips to improve:</div>
      <ul class="tips-list">
        <li>Practice speaking for a full two minutes without stopping. If you get stuck on a word, try expressing your idea in a different way.</li>
        <li>Listen to short videos of native speakers of English. Try repeating what they say, imitating the pace and the location of pauses.</li>
      </ul>
    </div>

    <!-- Pronunciation card -->
    <div class="capability-card">
      <div class="capability-header">Pronunciation</div>
      <div class="capability-meta">
        GSE: 69/90 &nbsp;&nbsp; Versant: 64/80 &nbsp;&nbsp; CEFR: B2+
      </div>
      <div class="capability-text">
        Candidate produces most vowels and consonants in a clear manner, although an occasional
        mispronunciation may occur. Stress is placed correctly in most common words.
      </div>
      <div class="tips-title">Tips to improve:</div>
      <ul class="tips-list">
        <li>Look up commonly mispronounced words in English and learn how to say them correctly.</li>
        <li>Listen to a video clip of a native English speaker. Pause the video after each sentence and repeat it exactly, imitating the speaker's rhythm.</li>
      </ul>
    </div>
  </div>

  <div class="section-title" style="margin-top: 0;">Understanding the Skills</div>

  <div class="understanding-section">
    <div class="understanding-block">
      <div class="understanding-title">Sentence Mastery</div>
      <div class="understanding-text">
        Sentence Mastery reflects the ability to understand, recall and produce English phrases and clauses in
        complete sentences. Performance depends on accurate syntactic processing and appropriate usage of
        words, phrases and clauses in meaningful sentence structures.
      </div>
    </div>

    <div class="understanding-block">
      <div class="understanding-title">Vocabulary</div>
      <div class="understanding-text">
        Vocabulary reflects the ability to understand common everyday words spoken in sentence context and to
        produce such words as needed. Performance depends on familiarity with the form and meaning of
        everyday words and their use in connected speech.
      </div>
    </div>

    <div class="understanding-block">
      <div class="understanding-title">Fluency</div>
      <div class="understanding-text">
        Fluency reflects the rhythm, phrasing and timing evident in constructing, reading and repeating
        sentences.
      </div>
    </div>

    <div class="understanding-block">
      <div class="understanding-title">Pronunciation</div>
      <div class="understanding-text">
        Pronunciation reflects the ability to produce consonants, vowels and stress in a native-like manner in
        sentence context. Performance depends on knowledge of the phonological structure of everyday
        words.
      </div>
    </div>
  </div>

  <div class="tin-note">
    TIN: 12345678
  </div>

  <div class="footer">
    <div class="footer-left">
      <strong>Ministry of Coal, Government of India</strong> · Confidential · For internal evaluation purposes only.<br />
      Generated: 20 Nov 2025
    </div>
    <div class="footer-right">
      <div class="page-number">Page 2 of 2</div>
    </div>
  </div>
</div>

</body>
</html>
